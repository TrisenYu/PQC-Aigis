#include <stdio.h>
#include <stdint.h>

const int16_t zetas[256] = { 0,3777,-3182,3625,-3696,-1100,2456,2194,121,-2250,834,-2495,-2319,2876,-1701,1414,2816,-2088,-2237,1986,-1599,1993,3706,-2006,-1525,-2557,1296,1483,-2830,3364,617,1921,-3689,-1738,3266,-3600,810,1887,-638,-7,-438,-679,-1305,-1760,396,-3174,-3555,-1881,3772,-2535,-2440,-2555,1535,-549,3153,2310,-1399,1321,514,-2956,-103,2804,-2043,-1431,-1054,1698,-3456,1166,2426,3831,915,-2,-3417,-194,2919,2789,3405,2385,-2113,-2732,2175,373,3692,-730,-1756,3135,-2391,660,-1497,2572,-3145,1350,-2224,-3588,-1681,2883,-1390,1598,3750,2762,2835,2764,-2233,3816,-1533,1464,-727,1521,1386,-3428,-921,-2743,-2160,2649,-859,2579,1532,1919,-486,404,-1056,783,1799,-2665,3480,2133,-3310,-1168,-17,3744,2422,2001,1278,929,-1348,-2230,-179,-1242,-2059,-1070,2161,1649,2072,3177,-2071,1121,-436,236,715,670,-658,-1476,-2378,2767,3542,-226,1203,1181,-151,-3794,1712,-222,2786,-451,-3547,1779,-1151,-434,3568,-3693,3581,-1586,1509,2918,2339,-1407,3434,-3550,2340,2891,2998,-3314,3461,-2719,-2247,-2589,1144,1072,1295,-2815,-3770,3450,3781,-2258,796,3163,-3208,-589,2963,-124,3214,3334,-3366,-3745,3723,1931,-429,-402,-3408,83,-1526,826,-1338,2345,-2303,2515,-642,-1837,-2965,-791,370,293,3312,2083,-1689,-777,2070,2262,-893,2386,-188,-1519,-2874,-1404,1012,2130,1441,2532,-3335,-1084,-3343,2937,509,-1403,2812,3763,592,2005,3657,2460,-3677,3752,692,1669,2167,-3287 };
const int16_t zetas_inv[256] = { 3287,-2167,-1669,-692,-3752,3677,-2460,-3657,-2005,-592,-3763,-2812,1403,-509,-2937,3343,1084,3335,-2532,-1441,-2130,-1012,1404,2874,1519,188,-2386,893,-2262,-2070,777,1689,-2083,-3312,-293,-370,791,2965,1837,642,-2515,2303,-2345,1338,-826,1526,-83,3408,402,429,-1931,-3723,3745,3366,-3334,-3214,124,-2963,589,3208,-3163,-796,2258,-3781,-3450,3770,2815,-1295,-1072,-1144,2589,2247,2719,-3461,3314,-2998,-2891,-2340,3550,-3434,1407,-2339,-2918,-1509,1586,-3581,3693,-3568,434,1151,-1779,3547,451,-2786,222,-1712,3794,151,-1181,-1203,226,-3542,-2767,2378,1476,658,-670,-715,-236,436,-1121,2071,-3177,-2072,-1649,-2161,1070,2059,1242,179,2230,1348,-929,-1278,-2001,-2422,-3744,17,1168,3310,-2133,-3480,2665,-1799,-783,1056,-404,486,-1919,-1532,-2579,859,-2649,2160,2743,921,3428,-1386,-1521,727,-1464,1533,-3816,2233,-2764,-2835,-2762,-3750,-1598,1390,-2883,1681,3588,2224,-1350,3145,-2572,1497,-660,2391,-3135,1756,730,-3692,-373,-2175,2732,2113,-2385,-3405,-2789,-2919,194,3417,2,-915,-3831,-2426,-1166,3456,-1698,1054,1431,2043,-2804,103,2956,-514,-1321,1399,-2310,-3153,549,-1535,2555,2440,2535,-3772,1881,3555,3174,-396,1760,1305,679,438,7,638,-1887,-810,3600,-3266,1738,3689,-1921,-617,-3364,2830,-1483,-1296,2557,1525,2006,-3706,-1993,1599,-1986,2237,2088,-2816,-1414,1701,-2876,2319,2495,-834,2250,-121,-2194,-2456,1100,3696,-3625,3182,-1905 };

//reduce from [-2^15 *7681,2^15*7681] to (-7681,7681) 
//In our application, the output is ensured 
//to be [-7441,7441]
int16_t montgomery_reduce(int32_t a)
{
	int16_t t;
	t = (int16_t)a*7679;
	t = (a + (int32_t)t*7681) >> 16;
	return t;
}
//reduce from [-61568,61568] to (-7681,7681)
//61568> 2^15 > 4*7681
int16_t barrett_reduce(int16_t a)
{
  int16_t u;
  u = (a + (1<<12)) >> 13;
  u *= 7681;
  a -= u;
  return a;
}

void ntt(int16_t *a)
{
	int level, start, j, k, step;
	int32_t zeta;
	int16_t t;

	k = 1;
	step = (1 << 7);
	for (start = 0; start < 256; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = a[j] - t;
			a[j] = a[j] + t;
		}
	}
	step = (1 << 6);
	for (start = 0; start < 256; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = barrett_reduce(a[j] - t);
			a[j] = barrett_reduce(a[j] + t);
		}
	}

	for (level = 5; level >= 4; level--)
	{
		step = (1 << level);
		for (start = 0; start < 256; start = j + step)
		{
			zeta = zetas[k++];
			for (j = start; j < start + step; ++j)
			{
				t = montgomery_reduce(zeta * a[j + step]);
				a[j + step] = a[j] - t;
				a[j] = a[j] + t;
			}
		}
	}
	step = (1 << 3);
	for (start = 0; start < 256; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = barrett_reduce(a[j] - t);
			a[j] = barrett_reduce(a[j] + t);
		}
	}
	for (level = 2; level >= 1; level--)
	{
		step = (1 << level);
		for (start = 0; start < 256; start = j + step)
		{
			zeta = zetas[k++];
			for (j = start; j < start + step; ++j)
			{
				t = montgomery_reduce(zeta * a[j + step]);
				a[j + step] = a[j] - t;
				a[j] = a[j] + t;
			}
		}
	}
	step = 1;
	for (start = 0; start < 256; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = barrett_reduce(a[j] - t);
			a[j] = barrett_reduce(a[j] + t);
		}
	}
}

void inv_ntt(int16_t * a) {
	int start, level, step, j, k;
	int32_t zeta, t;

	k = 0;
	for (level = 0; level < 7; level++) {
		step = (1 << level);
		for (start = 0; start < 256; start = j + step) {
			zeta = zetas_inv[k++];
			for (j = start; j < start + step; ++j)
			{
				t = a[j];
				a[j] += a[j + step];
				if (level & 1)
					a[j] = barrett_reduce(a[j]);
				else
					asm volatile("nop\r\n");
				t -= a[j + step];
				a[j + step] = montgomery_reduce(zeta * t);
			}
		}
	}

	step = (1 << 7);
	for (start = 0; start < 256; start = j + step) {
		zeta = zetas_inv[k++];
		for (j = start; j < start + step; ++j)
		{
			t = a[j];
			a[j] = t + a[j + step];
			a[j] = montgomery_reduce(256 * (int32_t)a[j]);
			t -= a[j + step];
			a[j + step] = montgomery_reduce(zeta * t);
		}
	}
}

#define     AIGIS_N                   256     // a_{0}+a_{1}X+...+a_{255}X^255 ~ (a0, a1, ..., a255)
#if (AIGIS_PARAM_CONF == 1)
  #define 	  AIGIS_SIG_MOD_Q 			    2021377
  #define     AIGIS_SIG_QBITS           21
  #define 	  AIGIS_SIG_MONT            1562548U    // 2^32 mod AIGIS_SIG_N
  #define     AIGIS_SIG_NEG_QINV        2849953791U // (-q)^(-1) mod 2^32
  #define     mont_invn                  1356777ULL
  static const uint32_t sig_zetas[AIGIS_N] = {1562548,518470,697898,862629,1367459,1539276,1513857,1662806,929015,1757045,1879015,449873,75689,1125711,1680345,620849,769419,486664,1389778,658915,1319993,73499,1391732,1199964,291970,655587,966181,128755,288564,10420,1980158,1011904,1937906,838813,854780,1453936,1704819,1740984,86645,1360044,115556,1570480,1655800,272433,1245520,1190005,238406,1726139,1013693,1948648,1020399,1544116,1120075,656153,591869,1620799,275832,517427,1601944,1555925,1293833,1705829,1357642,142050,739420,1568070,1535360,740638,57925,1038012,65439,1844105,673379,1768997,924638,1986117,1394208,1277276,129269,1760277,1173604,1161770,1897168,807697,965038,1876057,1963820,1794916,924093,251419,168030,1073286,1902394,347156,1488477,511116,572755,1686880,268077,53223,1268228,579769,1043786,272581,1574784,1729984,568576,276296,1095755,282107,158374,915466,1569380,908136,972609,923797,466409,1762448,798650,436051,1275685,1122838,1862,1854194,1432015,1507507,1452715,1170924,137295,531590,556763,1442250,896280,320184,333460,1993546,622613,1352919,881664,1176558,1936677,2011958,1357750,534023,142791,40293,638104,1519860,1189220,1763667,792470,1813814,830483,1256948,1537350,64760,561409,823180,786453,1106713,1491299,1582163,822179,1663832,1269819,84100,780824,310495,1043416,763923,1440072,1308437,1369984,1027053,641681,932722,1248044,318540,1777818,702544,1566714,1301662,265980,696370,1576958,449193,1228202,1635455,1143957,1349609,120737,1115065,1815624,573533,10820,1911846,533321,1147868,1126927,145151,641139,275750,276830,1257214,988074,1857331,105366,1608247,1752751,817865,294374,1145376,1447053,647982,1517128,301974,233775,1669708,1146108,1913137,707228,1147423,349817,1972001,777351,1874015,964313,161863,1142539,1331457,1604014,1320129,1103939,1236477,447210,1613614,1666811,51306,383284,1573619,677023,994549,23785,210391,461525,1779756,430663,84620,1731642,1784991,147098,942182,1953450,1853187,1567373,1541031};
  static const uint32_t sig_zetas_inv[AIGIS_N] = {480346,454004,168190,67927,1079195,1874279,236386,289735,1936757,1590714,241621,1559852,1810986,1997592,1026828,1344354,447758,1638093,1970071,354566,407763,1574167,784900,917438,701248,417363,689920,878838,1859514,1057064,147362,1244026,49376,1671560,873954,1314149,108240,875269,351669,1787602,1719403,504249,1373395,574324,876001,1727003,1203512,268626,413130,1916011,164046,1033303,764163,1744547,1745627,1380238,1876226,894450,873509,1488056,109531,2010557,1447844,205753,906312,1900640,671768,877420,385922,793175,1572184,444419,1325007,1755397,719715,454663,1318833,243559,1702837,773333,1088655,1379696,994324,651393,712940,581305,1257454,977961,1710882,1240553,1937277,751558,357545,1199198,439214,530078,914664,1234924,1198197,1459968,1956617,484027,764429,1190894,207563,1228907,257710,832157,501517,1383273,1981084,1878586,1487354,663627,9419,84700,844819,1139713,668458,1398764,27831,1687917,1701193,1125097,579127,1464614,1489787,1884082,850453,568662,513870,589362,167183,2019515,898539,745692,1585326,1222727,258929,1554968,1097580,1048768,1113241,451997,1105911,1863003,1739270,925622,1745081,1452801,291393,446593,1748796,977591,1441608,753149,1968154,1753300,334497,1448622,1510261,532900,1674221,118983,948091,1853347,1769958,1097284,226461,57557,145320,1056339,1213680,124209,859607,847773,261100,1892108,744101,627169,35260,1096739,252380,1347998,177272,1955938,983365,1963452,1280739,486017,453307,1281957,1879327,663735,315548,727544,465452,419433,1503950,1745545,400578,1429508,1365224,901302,477261,1000978,72729,1007684,295238,1782971,831372,775857,1748944,365577,450897,1905821,661333,1934732,280393,316558,567441,1166597,1182564,83471,1009473,41219,2010957,1732813,1892622,1055196,1365790,1729407,821413,629645,1947878,701384,1362462,631599,1534713,1251958,1400528,341032,895666,1945688,1571504,142362,264332,1092362,358571,507520,482101,653918,1158748,1323479,1331599};

#elif (AIGIS_PARAM_CONF == 2 || AIGIS_PARAM_CONF == 3)
  #define 	  AIGIS_SIG_MOD_Q 			    3870721
  #define     AIGIS_SIG_QBITS           22
  #define 	  AIGIS_SIG_MONT            2337707U    // 2^32 mod AIGIS_SIG_N
  #define     AIGIS_SIG_NEG_QINV        2671448063U // (-q)^(-1) mod 2^32
  #define     mont_invn                 3146698ULL
  static const uint32_t sig_zetas[AIGIS_N] = {2337707,2505409,267692,529914,420735,181988,2608440,3865338,3665767,288746,2524026,3008396,901579,70491,1821213,1437514,3375394,502705,3475623,3513653,1833017,3651222,947790,1966036,2704588,2850143,3030905,1622520,3210245,3127826,292206,3096784,3201921,3867412,1705316,2917474,2975359,2004421,2812268,890313,2511631,3623292,2803099,2903766,1596209,2040136,3468632,2156661,2913824,2560388,1214035,3468039,575792,2926910,3407464,2292204,2285761,2338667,63216,3835938,3204529,1818443,3786633,3241498,944328,616348,2927622,64038,1171534,1361903,2827360,3144828,2738981,1714811,3625146,89505,2787809,2363190,2513795,3306399,1418851,1206903,926563,211044,466372,3410093,1353383,3610570,934100,2471859,2037600,2996463,1698492,525418,1662944,1981925,1210222,1813802,314420,2466015,3516872,3320431,1355971,1500137,493991,36365,3235243,214827,2544017,1739057,945221,1038283,2889903,3364214,1674857,1434035,1665177,2651227,1575769,1155464,467835,1713031,2041544,408424,137443,2029527,2115209,2293884,2137416,3189891,2471629,2229785,2611740,2394735,2287191,2862622,300090,1004990,401830,143957,2910193,3787906,3628164,3171269,2239135,3038465,601725,2887353,2766912,1622354,2989501,1339396,1939160,2386893,103181,2793304,911193,3295333,3025653,2513246,314427,939239,57676,2293294,2833811,2842292,3139575,2705158,1290463,3780876,1462003,668827,1850975,2327221,2910099,2724881,418972,957090,321362,2898276,3523069,1463158,3818473,453440,1891547,1601731,529312,3301251,1117070,3520718,634170,1958581,929634,1133255,3807619,1159272,3292496,3530590,927442,3686531,2605292,384058,1415774,1040397,3663661,2332173,1131260,680774,1186917,3736575,1064994,2954460,3051663,1162037,2962553,2130376,1717870,3565361,2935922,2347272,1768863,3125776,1686747,3137894,2993356,1574419,1073008,1262182,183934,914847,3373156,3688758,2538361,614066,3211143,3565127,1322591,3426188,2951336,172348,3747492,3719872,2962113,778168,2880082,1051508,3741079,1816757,763621,328987,2831790,1276220,135870,3388537,3034187,2419032};
  static const uint32_t sig_zetas_inv[AIGIS_N] = {1451689,836534,482184,3734851,2594501,1038931,3541734,3107100,2053964,129642,2819213,990639,3092553,908608,150849,123229,3698373,919385,444533,2548130,305594,659578,3256655,1332360,181963,497565,2955874,3686787,2608539,2797713,2296302,877365,732827,2183974,744945,2101858,1523449,934799,305360,2152851,1740345,908168,2708684,819058,916261,2805727,134146,2683804,3189947,2739461,1538548,207060,2830324,2454947,3486663,1265429,184190,2943279,340131,578225,2711449,63102,2737466,2941087,1912140,3236551,350003,2753651,569470,3341409,2268990,1979174,3417281,52248,2407563,347652,972445,3549359,2913631,3451749,1145840,960622,1543500,2019746,3201894,2408718,89845,2580258,1165563,731146,1028429,1036910,1577427,3813045,2931482,3556294,1357475,845068,575388,2959528,1077417,3767540,1483828,1931561,2531325,881220,2248367,1103809,983368,3268996,832256,1631586,699452,242557,82815,960528,3726764,3468891,2865731,3570631,1008099,1583530,1475986,1258981,1640936,1399092,680830,1733305,1576837,1755512,1841194,3733278,3462297,1829177,2157690,3402886,2715257,2294952,1219494,2205544,2436686,2195864,506507,980818,2832438,2925500,2131664,1326704,3655894,635478,3834356,3376730,2370584,2514750,550290,353849,1404706,3556301,2056919,2660499,1888796,2207777,3345303,2172229,874258,1833121,1398862,2936621,260151,2517338,460628,3404349,3659677,2944158,2663818,2451870,564322,1356926,1507531,1082912,3781216,245575,2155910,1131740,725893,1043361,2508818,2699187,3806683,943099,3254373,2926393,629223,84088,2052278,666192,34783,3807505,1532054,1584960,1578517,463257,943811,3294929,402682,2656686,1310333,956897,1714060,402089,1830585,2274512,966955,1067622,247429,1359090,2980408,1058453,1866300,895362,953247,2165405,3309,668800,773937,3578515,742895,660476,2248201,839816,1020578,1166133,1904685,2922931,219499,2037704,357068,395098,3368016,495327,2433207,2049508,3800230,2969142,862325,1346695,3581975,204954,5383,1262281,3688733,3449986,3340807,3603029,951197};
#else 
  #error ""
#endif 

uint32_t sig_mont(uint64_t a) {
  uint64_t t = a * AIGIS_SIG_NEG_QINV;
  t &= (1ULL << 32) - 1;
  t *= AIGIS_SIG_MOD_Q;
  t += a;
  return t >> 32;
}
uint32_t sig_barr(uint32_t a) {
    return a - (a >> AIGIS_SIG_QBITS) * AIGIS_SIG_MOD_Q;
}


void sig_ntt(uint32_t p[AIGIS_N]) {
  unsigned int len, start, j, k = 1;
  uint32_t zeta, t;

  for(len = 128; len > 0; len >>= 1) {
    for(start = 0; start < AIGIS_N; start = j + len) {
      zeta = sig_zetas[k++];
      for(j = start; j < start + len; ++j) {
        t = sig_mont((uint64_t)zeta * p[j + len]);
        p[j + len] = p[j] + 2*AIGIS_SIG_MOD_Q - t;
        p[j] = p[j] + t;
      }
    }
  }
}

void sig_inv_ntt(uint32_t p[AIGIS_N]) {
  unsigned int start, len, j, k = 0;
  uint32_t t, zeta;
  
  for(len = 1; len < AIGIS_N; len <<= 1) {
    for(start = 0; start < AIGIS_N; start = j + len) {
      zeta = sig_zetas_inv[k++];
      for(j = start; j < start + len; ++j) {
        t = p[j];
        p[j] = sig_barr(t + p[j + len]);
		// Why need 512 ?
        p[j + len] = t + 512*AIGIS_SIG_MOD_Q - p[j + len];
        p[j + len] = sig_mont((uint64_t)zeta * p[j + len]);
      }
    }
  }

    for(j = 0; j < AIGIS_N/2; ++j) {
        p[j] = sig_mont(mont_invn * p[j]);
    }
}



int16_t a[256] = {
      1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16, 
     17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,  31,  32, 
     33,  34,  35,  36,  37,  38,  39,  40,  41,  42,  43,  44,  45,  46,  47,  48, 
     49,  50,  51,  52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64, 
     65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80, 
     81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96, 
     97,  98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 
    113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 
    129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 
    145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 
    161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 
    177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
    193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 
    209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 
    225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 
    241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256,
}, b[256] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1
};

uint32_t xa[256] = {
      1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  12,  13,  14,  15,  16, 
     17,  18,  19,  20,  21,  22,  23,  24,  25,  26,  27,  28,  29,  30,  31,  32, 
     33,  34,  35,  36,  37,  38,  39,  40,  41,  42,  43,  44,  45,  46,  47,  48, 
     49,  50,  51,  52,  53,  54,  55,  56,  57,  58,  59,  60,  61,  62,  63,  64, 
     65,  66,  67,  68,  69,  70,  71,  72,  73,  74,  75,  76,  77,  78,  79,  80, 
     81,  82,  83,  84,  85,  86,  87,  88,  89,  90,  91,  92,  93,  94,  95,  96, 
     97,  98,  99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 
    113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 
    129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 
    145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 
    161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 
    177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 
    193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 
    209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 
    225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 
    241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256,
}, xb[256] = {
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1
};



void dump_b() {
    for (int i = 0; i < 256; i ++) {
        printf("%2d, ", b[i]);
        if (!((i + 1) & 15)) {
            puts("");
        }
    }
}

int main() {
    ntt(a);
    ntt(b);
    for (int i = 0; i < 256; i ++) { 
        a[i] = (int32_t)(a[i]*b[i]) % 7681; 
    }
    inv_ntt(a);
    inv_ntt(b);
    for (int i = 0; i < 256; i ++) {
        printf("%3d, ", a[i]);
        if ((i + 1) % 16 == 0) { puts(""); }
    }
    dump_b();

	sig_ntt(xa);
	sig_ntt(xb);
	for (int i = 0; i < AIGIS_N; i ++) {
		xa[i] = (uint64_t)(xa[i] * xb[i]);
	}
	sig_inv_ntt(xa);
	sig_inv_ntt(xb);
	for (int i = 0; i < AIGIS_N; i ++) {
        printf("%3d, ", xa[i] % AIGIS_SIG_MOD_Q);
        if ((i + 1) % 16 == 0) { puts(""); }
    }
	for (int i = 0; i < AIGIS_N; i ++) {
        printf("%2d, ", xb[i] % AIGIS_SIG_MOD_Q);
        if ((i + 1) % 16 == 0) { puts(""); }
    }
}
